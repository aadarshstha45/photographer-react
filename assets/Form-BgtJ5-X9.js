import{p as C,l as J,r as i,j as t,q as O,F as I,T as V,H as K,B as W,t as R}from"./index-BCCTcgx6.js";import{R as A}from"./index-BHx-m5sd.js";import"./lodash-3m1QihGc.js";import{S as Q}from"./index-CkxYw2zV.js";import{u as X,T as P}from"./index-B5ZJUUTd.js";import{u as Y}from"./useGetDirtyData-Dc4_-Xhu.js";import{u as T}from"./useGetErrors-Bhs_yQR9.js";import{b as Z,c as $,d as w}from"./service-work-D8JKXQsk.js";import"./Plus-BKTAK1hg.js";import"./tslib.es6-KGZ4s6vb.js";import"./inputProps-D-yLYbQ0.js";import"./Trash-BrfYktzD.js";import"./visually-hidden.style-Bfr07Aua.js";import"./service-form-methods-D_Zmy-SD.js";const ge=()=>{var S;const m={title:"",description:"",image:"",is_active:"1",images:[]},{id:a}=C(),{mutateAsync:_,isPending:q,isError:u,error:l}=Z(),{mutateAsync:z,isPending:B,isError:g,error:x}=$(),c=J(),{control:r,handleSubmit:H,reset:o,formState:M}=X({defaultValues:m}),{data:e,isFetching:U}=w(parseInt(a)),[k,f]=i.useState([]),[h,G]=i.useState(!1),[b,L]=i.useState([]),[p,E]=i.useState({});i.useEffect(()=>{u?E(T(l)):g&&E(T(x))},[u,g,l,x]),i.useEffect(()=>{var n,s,d,v,j,y,D;a?(o({title:(n=e==null?void 0:e.data)==null?void 0:n.title,description:(s=e==null?void 0:e.data)==null?void 0:s.description,image:(d=e==null?void 0:e.data)==null?void 0:d.image,is_active:(v=e==null?void 0:e.data)!=null&&v.is_active?"1":"0"}),(((j=e==null?void 0:e.data)==null?void 0:j.images.length)??!1)&&f(((D=(y=e==null?void 0:e.data)==null?void 0:y.images)==null?void 0:D.map(F=>({id:F.id,url:F.image})))||[])):o(m)},[a,o,e==null?void 0:e.data]);const N=async n=>{const s=a?R(Y(M,n)):R(n);a?(b.length>0&&s.append("deleted_images",JSON.stringify(b)),h&&s.append("remove_image",h),(await z({id:a,data:s})).data.status&&(o(m),c("/my-works"))):(await _({data:s})).data.status&&(o(m),c("/my-works"))};return U?t.jsx(O,{height:"70dvh",width:"70dvw"}):t.jsxs(I,{flexDir:"column",gap:4,children:[t.jsxs(V,{fontWeight:600,fontSize:"2xl",children:[a?"Edit":"Add"," Work"]}),t.jsxs(I,{gap:4,flexDir:"column",as:"form",onSubmit:H(N),children:[t.jsx(P,{name:"title",control:r,label:"Title",backendError:p.title,isRequired:!0}),t.jsx(P,{control:r,name:"description",type:"textarea",label:"Description"}),t.jsx(A,{name:"image",control:r,label:"Image",options:{accept:{"image/*":[]}},boxWidth:"250px",boxHeight:"250px",file:a?(S=e==null?void 0:e.data)==null?void 0:S.image:"",isRequired:!0,noMaxSize:!0,backendError:p.image,setRemoveImage:G}),t.jsx(A,{isMultiple:!0,name:"images",control:r,label:"Images",options:{accept:{"image/*":[]}},noMaxSize:!0,prevFiles:k,setPrevFiles:f,setDeleteImages:L,width:"100%",boxWidth:"250px",boxHeight:"250px",isRequired:!0,backendError:p.images}),t.jsx(Q,{control:r}),t.jsxs(K,{spacing:2,my:6,children:[t.jsx(W,{variant:"outline",onClick:()=>c(-1),children:"Back"}),t.jsx(W,{type:"submit",isLoading:a?B:q,children:"Submit"})]})]})]})};export{ge as default};
